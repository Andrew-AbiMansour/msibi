import numpy as np

rdf_relative_tol = 0.01
rdf_absolute_tol = 0.01

pairs = []

for pair in pairs:
    for state in pair.states:
        err = np.inf
        while err < rdf_relative_tol:
            run
            calc_currentk
            update
